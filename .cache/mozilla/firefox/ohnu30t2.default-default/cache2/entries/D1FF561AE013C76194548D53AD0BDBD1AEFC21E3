!function(){"use strict";var e;function t(t,n,i=e.Debug){const r=`(Glean.${t})`;Array.isArray(n)?console[i](r,...n):console[i](r,n)}!function(e){e.Debug="debug",e.Info="info",e.Warn="warn",e.Error="error",e.Trace="trace"}(e||(e={}));var n;!function(e){e[e.RecoverableFailure=0]="RecoverableFailure",e[e.UnrecoverableFailure=1]="UnrecoverableFailure",e[e.Success=2]="Success"}(n||(n={}));class i{constructor(e,t){this.result=e,this.status=t}}var r=class{};const s="platform.browser.FetchUploader";var a=new class extends r{constructor(){super(...arguments),this.timeoutMs=1e4}async post(n,r,a=!0){const o=new AbortController,c=setTimeout((()=>o.abort()),this.timeoutMs),l=r.asCompressedPayload();let d;try{d=await fetch(n.toString(),{headers:l.headers,method:"POST",body:l.payload,keepalive:a,credentials:"omit",signal:o.signal,redirect:"error"})}catch(u){if(u instanceof DOMException)t(s,["Timeout while attempting to upload ping.\n",u],e.Error);else if(u instanceof TypeError){if(a)return this.post(n,l,!1);t(s,["Network error while attempting to upload ping.\n",u],e.Error)}else t(s,["Unknown error while attempting to upload ping.\n",u],e.Error);return clearTimeout(c),new i(0)}return clearTimeout(c),new i(2,d.status)}supportsCustomHeaders(){return!0}};var o=new class extends r{constructor(){super(...arguments),this.timeoutMs=1e4}async post(n,r,s=!0){return navigator.sendBeacon(n,r.payload)?new i(2,200):(s&&t("platform.browser.SendBeaconUploader","The `sendBeacon` call was not serviced by the browser. Deleting data.",e.Error),new i(1))}supportsCustomHeaders(){return!1}};const c="core.Context";class l{constructor(){this.initialized=!1,this.testing=!1,this.supportedMetrics={},this.startTime=new Date}static get instance(){return l._instance||(l._instance=new l),l._instance}static testUninitialize(){l._instance=undefined}static get uploadEnabled(){return"undefined"==typeof l.instance.uploadEnabled&&t(c,["Attempted to access Context.uploadEnabled before it was set. This may cause unexpected behaviour."],e.Trace),l.instance.uploadEnabled}static set uploadEnabled(e){l.instance.uploadEnabled=e}static get metricsDatabase(){return"undefined"==typeof l.instance.metricsDatabase&&t(c,["Attempted to access Context.metricsDatabase before it was set. This may cause unexpected behaviour."],e.Trace),l.instance.metricsDatabase}static set metricsDatabase(e){l.instance.metricsDatabase=e}static get eventsDatabase(){return"undefined"==typeof l.instance.eventsDatabase&&t(c,["Attempted to access Context.eventsDatabase before it was set. This may cause unexpected behaviour."],e.Trace),l.instance.eventsDatabase}static set eventsDatabase(e){l.instance.eventsDatabase=e}static get pingsDatabase(){return"undefined"==typeof l.instance.pingsDatabase&&t(c,["Attempted to access Context.pingsDatabase before it was set. This may cause unexpected behaviour."],e.Trace),l.instance.pingsDatabase}static set pingsDatabase(e){l.instance.pingsDatabase=e}static get errorManager(){return"undefined"==typeof l.instance.errorManager&&t(c,["Attempted to access Context.errorManager before it was set. This may cause unexpected behaviour."],e.Trace),l.instance.errorManager}static set errorManager(e){l.instance.errorManager=e}static get applicationId(){return"undefined"==typeof l.instance.applicationId&&t(c,["Attempted to access Context.applicationId before it was set. This may cause unexpected behaviour."],e.Trace),l.instance.applicationId}static set applicationId(e){l.instance.applicationId=e}static get initialized(){return l.instance.initialized}static set initialized(e){l.instance.initialized=e}static get config(){return"undefined"==typeof l.instance.config&&t(c,["Attempted to access Context.config before it was set. This may cause unexpected behaviour."],e.Trace),l.instance.config}static set config(e){l.instance.config=e}static get startTime(){return l.instance.startTime}static get testing(){return l.instance.testing}static set testing(e){l.instance.testing=e}static get corePings(){return l.instance.corePings}static set corePings(e){l.instance.corePings=e}static get coreMetrics(){return l.instance.coreMetrics}static set coreMetrics(e){l.instance.coreMetrics=e}static set platform(e){l.instance.platform=e}static get platform(){return"undefined"==typeof l.instance.platform&&t(c,["Attempted to access Context.platform before it was set. This may cause unexpected behaviour."],e.Trace),l.instance.platform}static isPlatformSet(){return!!l.instance.platform}static getSupportedMetric(e){return l.instance.supportedMetrics[e]}static addSupportedMetric(e,t){e in l.instance.supportedMetrics||(l.instance.supportedMetrics[e]=t)}}const d="platform.browser.SendBeaconFallbackUploader";var u=new class extends r{constructor(){super(...arguments),this.fetchUploader=a,this.sendBeaconUploader=o}async post(n,i){var r,s;if(!(null===(r=l.config)||void 0===r?void 0:r.sourceTags)&&!(null===(s=l.config)||void 0===s?void 0:s.debugViewTag)&&navigator&&navigator.sendBeacon){const r=await this.sendBeaconUploader.post(n,i,!1);if(2==r.result)return r;t(d,"The `sendBeacon` call was not serviced by the browser. Falling back to the `fetch` uploader.",e.Warn)}else t(d,"`sendBeacon` is not available. Falling back to the `fetch` uploader.",e.Warn);return this.fetchUploader.post(n,i)}supportsCustomHeaders(){return!1}};var g={os(){let e;return e=navigator&&navigator.userAgent?navigator.userAgent:"Unknown",e.includes("Windows")?"Windows":/tvOS/i.test(e)?"TvOS":/Watch( OS)?/i.test(e)?"WatchOS":/iPhone|iPad|iOS/i.test(e)?"iOS":/Mac OS X|macOS/i.test(e)?"Darwin":/Android/i.test(e)?"Android":/CrOS/i.test(e)?"ChromeOS":/WebOS/i.test(e)?"WebOS":/Linux/i.test(e)?"Linux":/OpenBSD/i.test(e)?"OpenBSD":/FreeBSD/i.test(e)?"FreeBSD":/NetBSD/i.test(e)?"NetBSD":/SunOS/i.test(e)?"SunOS":/AIX/i.test(e)?"IBM_AIX":"Unknown"},osVersion(){return"Unknown"},arch(){return"Unknown"},locale(){return navigator&&navigator.language?navigator.language:"und"}};var f={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let p;const h=new Uint8Array(16);function m(){if(!p&&(p="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!p))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return p(h)}const b=[];for(let e=0;e<256;++e)b.push((e+256).toString(16).slice(1));function v(e,t=0){return(b[e[t+0]]+b[e[t+1]]+b[e[t+2]]+b[e[t+3]]+"-"+b[e[t+4]]+b[e[t+5]]+"-"+b[e[t+6]]+b[e[t+7]]+"-"+b[e[t+8]]+b[e[t+9]]+"-"+b[e[t+10]]+b[e[t+11]]+b[e[t+12]]+b[e[t+13]]+b[e[t+14]]+b[e[t+15]]).toLowerCase()}var y,w,S=function(e,t,n){if(f.randomUUID&&!t&&!e)return f.randomUUID();const i=(e=e||{}).random||(e.rng||m)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return v(i)};!function(e){e.InvalidValue="invalid_value",e.InvalidLabel="invalid_label",e.InvalidState="invalid_state",e.InvalidOverflow="invalid_overflow",e.InvalidType="invalid_type"}(y||(y={})),function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(w||(w={}));class E extends Error{constructor(e,t=y.InvalidType){super(e),this.type=t,this.name="MetricValidationError"}recordError(e){l.errorManager.record(e,this.type,this.message)}}class I{constructor(e){this.inner=this.validateOrThrow(e)}get(){return this.inner}set(e){this.inner=e}validateOrThrow(e){const t=this.validate(e);if(t.type===w.Error)throw new E(t.errorMessage,t.errorType);return e}}function D(e){if(P(e)||M(e)||$(e))return!0;if(T(e)){if(0===Object.keys(e).length)return!0;for(const t in e)return D(e[t])}return!!Array.isArray(e)&&e.every((e=>D(e)))}function T(e){return"object"==typeof e&&null!==e&&e.constructor===Object}function x(e){return void 0===e}function P(e){return"string"==typeof e}function M(e){return"boolean"==typeof e}function $(e){return"number"==typeof e&&!isNaN(e)}function _(e){return $(e)&&Number.isInteger(e)}function U(e){return/^[a-z0-9-]{1,20}$/i.test(e)}function k(){return"undefined"!=typeof crypto?S():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}function C(){const e="undefined"==typeof performance?Date.now():performance.now();return Math.round(e)}function A(e,t,n){if(!P(t))throw new E(`Expected string, got ${JSON.stringify(t)}`);const i=new TextEncoder,r=new TextDecoder("utf-8"),s=i.encode(t).slice(0,n),a=r.decode(s);return a!==t&&l.errorManager.record(e,y.InvalidOverflow,`Value length ${new Blob([t]).size} exceeds maximum of ${t.length} bytes.`),a}function O(n,i="core.utils"){return!!l.testing||(t(i,[`Attempted to access test only method \`${n||"unknown"}\`,`,"but Glean is not in testing mode. Ignoring. Make sure to put Glean in testing mode","before accessing such methods, by calling `testResetGlean`."],e.Error),!1)}function z(){return"undefined"==typeof window}const L="platform.web.Storage";var G=class{constructor(e){this.rootKey=e,this.logTag=`${L}.${e}`}get(n=[]){if(z())return;let i;try{const e=localStorage.getItem(this.rootKey)||"{}",t=JSON.parse(e);i=n.length>0?function(e,t){if(0===t.length)throw Error("The index must contain at least one property to get.");let n=e;for(const e of t){if(!T(n)||!(e in n))return;{const t=n[e];D(t)&&(n=t)}}return n}(t,n):0===Object.keys(t).length?undefined:t}catch(Se){t(L,["Unable to fetch value from local storage.",Se],e.Error)}return this.shouldUpdateSession(n)&&l.coreMetrics.updateSessionInfo(),i}update(n,i){if(!z()){try{const e=localStorage.getItem(this.rootKey)||"{}",t=function(e,t,n){if(0===t.length)throw Error("The index must contain at least one property to update.");const i={...e};let r=i;for(const e of t.slice(0,t.length-1))T(r[e])||(r[e]={}),r=r[e];const s=t[t.length-1],a=n(r[s]);return r[s]=a,i}(JSON.parse(e),n,i);localStorage.setItem(this.rootKey,JSON.stringify(t))}catch(Se){t(L,["Unable to update value from local storage.",Se],e.Error)}this.shouldUpdateSession(n)&&l.coreMetrics.updateSessionInfo()}}"delete"(n){if(!z()){try{const r=localStorage.getItem(this.rootKey)||"{}",s=JSON.parse(r);if(0===n.length)localStorage.removeItem(this.rootKey);else try{const e=function(e,t){if(0===t.length)return{};const n={...e};let i=n;for(const e of t.slice(0,t.length-1)){const n=i[e];if(!T(n))throw Error(`Attempted to delete an entry from an inexistent index: ${JSON.stringify(t)}.`);i=n}return delete i[t[t.length-1]],n}(s,n);localStorage.setItem(this.rootKey,JSON.stringify(e))}catch(i){t(this.logTag,[`Error attempting to delete key ${n.toString()} from storage. Ignoring.`,i],e.Warn)}}catch(Se){t(L,["Unable to delete value from storage.",Se],e.Error)}this.shouldUpdateSession(n)&&l.coreMetrics.updateSessionInfo()}}shouldUpdateSession(e){return!e.includes("session_id")&&!e.includes("session_count")}};var N={Storage:G,uploader:u,info:g,timer:{setTimeout:setTimeout,clearTimeout:clearTimeout},name:"web"};const V=1,R="5.0.3",B="glean_ping_info",F="glean_client_info",W="c0ffeec0-ffee-c0ff-eec0-ffeec0ffeec0",j="deletion-request",J="events",q="#glean_reference_time",H="#glean_execution_counter",K=[H,q],X="core.Config";class Q{constructor(e){var t,n;if(this.channel=null==e?void 0:e.channel,this.appBuild=null==e?void 0:e.appBuild,this.appDisplayVersion=null==e?void 0:e.appDisplayVersion,this.buildDate=null==e?void 0:e.buildDate,this.maxEvents=(null==e?void 0:e.maxEvents)||1,this.enableAutoPageLoadEvents=null==e?void 0:e.enableAutoPageLoadEvents,this.enableAutoElementClickEvents=null==e?void 0:e.enableAutoElementClickEvents,this.experimentationId=null==e?void 0:e.experimentationId,this.sessionLengthInMinutesOverride=null==e?void 0:e.sessionLengthInMinutesOverride,this.debug={},(null==e?void 0:e.serverEndpoint)&&(n=e.serverEndpoint,!/^(http|https):\/\/[a-zA-Z0-9._-]+(:\d+){0,1}(\/{0,1})$/i.test(n)))throw new Error(`Unable to initialize Glean, serverEndpoint ${e.serverEndpoint} is an invalid URL.`);if(!l.testing&&(null===(t=null==e?void 0:e.serverEndpoint)||void 0===t?void 0:t.startsWith("http:")))throw new Error(`Unable to initialize Glean, serverEndpoint ${e.serverEndpoint} must use the HTTPS protocol.`);this.serverEndpoint=e&&e.serverEndpoint?e.serverEndpoint:"https://incoming.telemetry.mozilla.org",this.httpClient=null==e?void 0:e.httpClient}get logPings(){return this.debug.logPings||!1}set logPings(e){this.debug.logPings=e}get debugViewTag(){return this.debug.debugViewTag}set debugViewTag(n){U(n||"")?this.debug.debugViewTag=n:t(X,[`"${n||""}" is not a valid \`debugViewTag\` value.`,"Please make sure the value passed satisfies the regex `^[a-zA-Z0-9-]{1,20}$`."],e.Error)}get sourceTags(){return this.debug.sourceTags}set sourceTags(n){if(!n||n.length<1||n.length>5)t(X,"A list of tags cannot contain more than 5 elements or less than one.",e.Error);else{for(const i of n){if(i.startsWith("glean"))return void t(X,"Tags starting with `glean` are reserved and must not be used.",e.Error);if(!U(i))return}this.debug.sourceTags=n}}}var Y=Uint8Array,Z=Uint16Array,ee=Int32Array,te=new Y([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ne=new Y([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ie=new Y([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),re=function(e,t){for(var n=new Z(31),i=0;i<31;++i)n[i]=t+=1<<e[i-1];var r=new ee(n[30]);for(i=1;i<30;++i)for(var s=n[i];s<n[i+1];++s)r[s]=s-n[i]<<5|i;return{b:n,r:r}},se=re(te,2),ae=se.b,oe=se.r;ae[28]=258,oe[258]=28;for(var ce=re(ne,0),le=(ce.b,ce.r),de=new Z(32768),ue=0;ue<32768;++ue){var ge=(43690&ue)>>1|(21845&ue)<<1;ge=(61680&(ge=(52428&ge)>>2|(13107&ge)<<2))>>4|(3855&ge)<<4,de[ue]=((65280&ge)>>8|(255&ge)<<8)>>1}var fe=function(e,t,n){for(var i=e.length,r=0,s=new Z(t);r<i;++r)e[r]&&++s[e[r]-1];var a,o=new Z(t);for(r=1;r<t;++r)o[r]=o[r-1]+s[r-1]<<1;if(n){a=new Z(1<<t);var c=15-t;for(r=0;r<i;++r)if(e[r])for(var l=r<<4|e[r],d=t-e[r],u=o[e[r]-1]++<<d,g=u|(1<<d)-1;u<=g;++u)a[de[u]>>c]=l}else for(a=new Z(i),r=0;r<i;++r)e[r]&&(a[r]=de[o[e[r]-1]++]>>15-e[r]);return a},pe=new Y(288);for(ue=0;ue<144;++ue)pe[ue]=8;for(ue=144;ue<256;++ue)pe[ue]=9;for(ue=256;ue<280;++ue)pe[ue]=7;for(ue=280;ue<288;++ue)pe[ue]=8;var he=new Y(32);for(ue=0;ue<32;++ue)he[ue]=5;var me=fe(pe,9,0),be=fe(he,5,0),ve=function(e){return(e+7)/8|0},ye=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var i=new Y(n-t);return i.set(e.subarray(t,n)),i},we=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Se=function(e,t,n){var i=new Error(t||we[e]);if(i.code=e,Error.captureStackTrace&&Error.captureStackTrace(i,Se),!n)throw i;return i},Ee=function(e,t,n){n<<=7&t;var i=t/8|0;e[i]|=n,e[i+1]|=n>>8},Ie=function(e,t,n){n<<=7&t;var i=t/8|0;e[i]|=n,e[i+1]|=n>>8,e[i+2]|=n>>16},De=function(e,t){for(var n=[],i=0;i<e.length;++i)e[i]&&n.push({s:i,f:e[i]});var r=n.length,s=n.slice();if(!r)return{t:Ue,l:0};if(1==r){var a=new Y(n[0].s+1);return a[n[0].s]=1,{t:a,l:1}}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var o=n[0],c=n[1],l=0,d=1,u=2;for(n[0]={s:-1,f:o.f+c.f,l:o,r:c};d!=r-1;)o=n[n[l].f<n[u].f?l++:u++],c=n[l!=d&&n[l].f<n[u].f?l++:u++],n[d++]={s:-1,f:o.f+c.f,l:o,r:c};var g=s[0].s;for(i=1;i<r;++i)s[i].s>g&&(g=s[i].s);var f=new Z(g+1),p=Te(n[d-1],f,0);if(p>t){i=0;var h=0,m=p-t,b=1<<m;for(s.sort((function(e,t){return f[t.s]-f[e.s]||e.f-t.f}));i<r;++i){var v=s[i].s;if(!(f[v]>t))break;h+=b-(1<<p-f[v]),f[v]=t}for(h>>=m;h>0;){var y=s[i].s;f[y]<t?h-=1<<t-f[y]++-1:++i}for(;i>=0&&h;--i){var w=s[i].s;f[w]==t&&(--f[w],++h)}p=t}return{t:new Y(f),l:p}},Te=function(e,t,n){return-1==e.s?Math.max(Te(e.l,t,n+1),Te(e.r,t,n+1)):t[e.s]=n},xe=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new Z(++t),i=0,r=e[0],s=1,a=function(e){n[i++]=e},o=1;o<=t;++o)if(e[o]==r&&o!=t)++s;else{if(!r&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(r),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(r);s=1,r=e[o]}return{c:n.subarray(0,i),n:t}},Pe=function(e,t){for(var n=0,i=0;i<t.length;++i)n+=e[i]*t[i];return n},Me=function(e,t,n){var i=n.length,r=ve(t+2);e[r]=255&i,e[r+1]=i>>8,e[r+2]=255^e[r],e[r+3]=255^e[r+1];for(var s=0;s<i;++s)e[r+s+4]=n[s];return 8*(r+4+i)},$e=function(e,t,n,i,r,s,a,o,c,l,d){Ee(t,d++,n),++r[256];for(var u=De(r,15),g=u.t,f=u.l,p=De(s,15),h=p.t,m=p.l,b=xe(g),v=b.c,y=b.n,w=xe(h),S=w.c,E=w.n,I=new Z(19),D=0;D<v.length;++D)++I[31&v[D]];for(D=0;D<S.length;++D)++I[31&S[D]];for(var T=De(I,7),x=T.t,P=T.l,M=19;M>4&&!x[ie[M-1]];--M);var $,_,U,k,C=l+5<<3,A=Pe(r,pe)+Pe(s,he)+a,O=Pe(r,g)+Pe(s,h)+a+14+3*M+Pe(I,x)+2*I[16]+3*I[17]+7*I[18];if(c>=0&&C<=A&&C<=O)return Me(t,d,e.subarray(c,c+l));if(Ee(t,d,1+(O<A)),d+=2,O<A){$=fe(g,f,0),_=g,U=fe(h,m,0),k=h;var z=fe(x,P,0);Ee(t,d,y-257),Ee(t,d+5,E-1),Ee(t,d+10,M-4),d+=14;for(D=0;D<M;++D)Ee(t,d+3*D,x[ie[D]]);d+=3*M;for(var L=[v,S],G=0;G<2;++G){var N=L[G];for(D=0;D<N.length;++D){var V=31&N[D];Ee(t,d,z[V]),d+=x[V],V>15&&(Ee(t,d,N[D]>>5&127),d+=N[D]>>12)}}}else $=me,_=pe,U=be,k=he;for(D=0;D<o;++D){var R=i[D];if(R>255){Ie(t,d,$[(V=R>>18&31)+257]),d+=_[V+257],V>7&&(Ee(t,d,R>>23&31),d+=te[V]);var B=31&R;Ie(t,d,U[B]),d+=k[B],B>3&&(Ie(t,d,R>>5&8191),d+=ne[B])}else Ie(t,d,$[R]),d+=_[R]}return Ie(t,d,$[256]),d+_[256]},_e=new ee([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ue=new Y(0),ke=function(e,t,n,i,r,s){var a=s.z||e.length,o=new Y(i+a+5*(1+Math.ceil(a/7e3))+r),c=o.subarray(i,o.length-r),l=s.l,d=7&(s.r||0);if(t){d&&(c[0]=s.r>>3);for(var u=_e[t-1],g=u>>13,f=8191&u,p=(1<<n)-1,h=s.p||new Z(32768),m=s.h||new Z(p+1),b=Math.ceil(n/3),v=2*b,y=function(t){return(e[t]^e[t+1]<<b^e[t+2]<<v)&p},w=new ee(25e3),S=new Z(288),E=new Z(32),I=0,D=0,T=s.i||0,x=0,P=s.w||0,M=0;T+2<a;++T){var $=y(T),_=32767&T,U=m[$];if(h[_]=U,m[$]=_,P<=T){var k=a-T;if((I>7e3||x>24576)&&(k>423||!l)){d=$e(e,c,0,w,S,E,D,x,M,T-M,d),x=I=D=0,M=T;for(var C=0;C<286;++C)S[C]=0;for(C=0;C<30;++C)E[C]=0}var A=2,O=0,z=f,L=_-U&32767;if(k>2&&$==y(T-L))for(var G=Math.min(g,k)-1,N=Math.min(32767,T),V=Math.min(258,k);L<=N&&--z&&_!=U;){if(e[T+A]==e[T+A-L]){for(var R=0;R<V&&e[T+R]==e[T+R-L];++R);if(R>A){if(A=R,O=L,R>G)break;var B=Math.min(L,R-2),F=0;for(C=0;C<B;++C){var W=T-L+C&32767,j=W-h[W]&32767;j>F&&(F=j,U=W)}}}L+=(_=U)-(U=h[_])&32767}if(O){w[x++]=268435456|oe[A]<<18|le[O];var J=31&oe[A],q=31&le[O];D+=te[J]+ne[q],++S[257+J],++E[q],P=T+A,++I}else w[x++]=e[T],++S[e[T]]}}for(T=Math.max(T,P);T<a;++T)w[x++]=e[T],++S[e[T]];d=$e(e,c,l,w,S,E,D,x,M,T-M,d),l||(s.r=7&d|c[d/8|0]<<3,d-=7,s.h=m,s.p=h,s.i=T,s.w=P)}else{for(T=s.w||0;T<a+l;T+=65535){var H=T+65535;H>=a&&(c[d/8|0]=l,H=a),d=Me(c,d+1,e.subarray(T,H))}s.i=a}return ye(o,0,i+ve(d)+r)},Ce=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,i=9;--i;)n=(1&n&&-306674912)^n>>>1;e[t]=n}return e}(),Ae=function(){var e=-1;return{p:function(t){for(var n=e,i=0;i<t.length;++i)n=Ce[255&n^t[i]]^n>>>8;e=n},d:function(){return~e}}},Oe=function(e,t,n,i,r){if(!r&&(r={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),a=new Y(s.length+e.length);a.set(s),a.set(e,s.length),e=a,r.w=s.length}return ke(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,i,r)},ze=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},Le=function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&ze(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var i=0;i<=n.length;++i)e[i+10]=n.charCodeAt(i)}},Ge=function(e){return 10+(e.filename?e.filename.length+1:0)};function Ne(e,t){t||(t={});var n=Ae(),i=e.length;n.p(e);var r=Oe(e,t,Ge(t),8),s=r.length;return Le(r,t),ze(r,s-8,n.d()),ze(r,s-4,i),r}var Ve="undefined"!=typeof TextEncoder&&new TextEncoder,Re="undefined"!=typeof TextDecoder&&new TextDecoder;try{Re.decode(Ue,{stream:!0}),1}catch(In){}function Be(e,t){if(t){for(var n=new Y(e.length),i=0;i<e.length;++i)n[i]=e.charCodeAt(i);return n}if(Ve)return Ve.encode(e);var r=e.length,s=new Y(e.length+(e.length>>1)),a=0,o=function(e){s[a++]=e};for(i=0;i<r;++i){if(a+5>s.length){var c=new Y(a+8+(r-i<<1));c.set(s),s=c}var l=e.charCodeAt(i);l<128||t?o(l):l<2048?(o(192|l>>6),o(128|63&l)):l>55295&&l<57344?(o(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++i))>>18),o(128|l>>12&63),o(128|l>>6&63),o(128|63&l)):(o(224|l>>12),o(128|l>>6&63),o(128|63&l))}return ye(s,0,a)}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;const Fe="core.Pings.Database";function We(e){return e.path.split("/")[3]===j}function je(e){return Be(JSON.stringify(e)).length}function Je(e){if(T(e)){const t="collectionDate"in e&&P(e.collectionDate)&&$(new Date(e.collectionDate).getTime()),n="path"in e&&P(e.path),i="payload"in e&&D(e.payload)&&T(e.payload),r=!("headers"in e)||D(e.headers)&&T(e.headers);return!!(t&&n&&i&&r)}return!1}var qe=class{constructor(){this.store=new l.platform.Storage("pings")}attachObserver(e){this.observer=e}recordPing(e,t,n,i){const r={collectionDate:(new Date).toISOString(),path:e,payload:n};i&&(r.headers=i),this.store.update([t],(()=>r)),this.observer&&this.observer.update(t,r)}deletePing(e){this.store["delete"]([e])}getAllPings(){const n=this.store.get(),i={};if(T(n))for(const r in n){const s=n[r];Je(s)?i[r]=s:(t(Fe,`Unexpected data found in pings database: ${JSON.stringify(s,null,2)}. Deleting.`,e.Warn),this.store["delete"]([r]))}return r=i,Object.entries(r).sort((([e,{collectionDate:t}],[n,{collectionDate:i}])=>new Date(t).getTime()-new Date(i).getTime()));var r}scanPendingPings(){if(!this.observer)return;const e=this.getAllPingsWithoutSurplus();for(const[t,n]of e)this.observer.update(t,n)}clearAll(){this.store["delete"]([])}getAllPingsWithoutSurplus(n=250,i=10485760){const r=this.getAllPings(),s=r.filter((([e,t])=>!We(t))).reverse(),a=r.filter((([e,t])=>We(t))),o=s.length;o>n&&t(Fe,[`More than ${n} pending pings in the pings database,`,`will delete ${o-n} old pings.`],e.Warn);let c=!1,l=0,d=0;const u=[];for(const[r,a]of s)l++,d+=je(a),!c&&d>i&&(t(Fe,[`Pending pings database has reached the size quota of ${i} bytes,`,"outstanding pings will be deleted."],e.Warn),c=!0),l>n&&(c=!0),c?this.deletePing(r):u.unshift([r,a]);return[...a,...u]}};var He;!function(e){e[e.Incrementing=0]="Incrementing",e[e.Throttled=1]="Throttled"}(He||(He={}));var Ke=class{constructor(e=6e4,t=40,n=0,i){this.interval=e,this.maxCount=t,this.count=n,this.started=i}get elapsed(){if(x(this.started))return NaN;const e=C()-this.started;return e<0?NaN:e}reset(){this.started=C(),this.count=0}shouldReset(){return!!x(this.started)||!!(isNaN(this.elapsed)||this.elapsed>this.interval)}getState(){this.shouldReset()&&this.reset();const e=this.interval-this.elapsed;return this.count>=this.maxCount?{state:1,remainingTime:e}:(this.count++,{state:0})}};class Xe{constructor(e=3,t=3,n=1048576){this.maxWaitAttempts=e,this.maxRecoverableFailures=t,this.maxPingBodySize=n}}class Qe extends Error{constructor(e){super(e),this.name="PingBodyOverflow"}}class Ye{constructor(e,t,n,i){this.identifier=e,this.headers=t,this.payload=n,this.maxBodySize=i}asCompressedPayload(){if("gzip"==this.headers["Content-Encoding"])return this;const e=Be(this.payload);let t;const n=this.headers;try{t=Ne(e),n["Content-Encoding"]="gzip",n["Content-Length"]=t.length.toString()}catch(se){return this}if(t.length>this.maxBodySize)throw new Qe(`Body for ping ${this.identifier} exceeds ${this.maxBodySize} bytes. Discarding.`);return new Ye(this.identifier,n,t,this.maxBodySize)}}const Ze="core.Upload.PingUploadWorker";var et,tt=class{constructor(e,t,n=new Xe){this.uploader=e,this.serverEndpoint=t,this.policy=n,this.isBlocking=!1}buildPingRequest(e){let t=e.headers||{};t={...e.headers,"Content-Type":"application/json; charset=utf-8",Date:(new Date).toISOString(),"X-Telemetry-Agent":`Glean/${R} (JS on ${l.platform.info.os()})`};const n=JSON.stringify(e.payload);if(n.length>this.policy.maxPingBodySize)throw new Qe(`Body for ping ${e.identifier} exceeds ${this.policy.maxPingBodySize}bytes. Discarding.`);return t["Content-Length"]=n.length.toString(),new Ye(e.identifier,t,n,this.policy.maxPingBodySize)}async attemptPingUpload(n){try{const e=this.buildPingRequest(n);return this.uploader.post(`${this.serverEndpoint}${n.path}`,e)}catch(In){return t(Ze,["Error trying to build or post ping request:",In],e.Warn),new i(1)}}work(n,i){for(;;)try{const e=n();switch(e.type){case"upload":if(this.isBlocking)return;this.attemptPingUpload(e.ping).then((t=>{i(e.ping,t)}))["catch"]((e=>{console.log(e)}));continue;case"done":return}}catch(r){t(Ze,["IMPOSSIBLE: Something went wrong while processing ping upload tasks.",r],e.Error)}}blockUploading(){this.isBlocking=!0}resumeUploading(){this.isBlocking=!1}};!function(e){e.Done="done",e.Wait="wait",e.Upload="upload"}(et||(et={}));var nt=()=>({type:"done"}),it=e=>({type:"wait",remainingTime:e}),rt=e=>({type:"upload",ping:e});const st="core.Upload.PingUploadManager";var at=class{constructor(e,t,n=new Xe,i=new Ke){this.pingsDatabase=t,this.policy=n,this.rateLimiter=i,this.recoverableFailureCount=0,this.waitAttemptCount=0,this.queue=[],this.processing=new Set,this.worker=new tt(e.httpClient?e.httpClient:l.platform.uploader,e.serverEndpoint,n),t.attachObserver(this)}getUploadTask(){const e=this.getUploadTaskInternal();return"wait"!==e.type&&this.waitAttemptCount>0&&(this.waitAttemptCount=0),"upload"!==e.type&&this.recoverableFailureCount>0&&(this.recoverableFailureCount=0),e}processPingUploadResponse(n,i){const{identifier:r}=n;this.processing.has(r)&&this.processing["delete"](r);const{status:s,result:a}=i;return s&&s>=200&&s<300?(t(st,`Ping ${r} successfully sent ${s}.`,e.Info),void this.pingsDatabase.deletePing(r)):1===a||s&&s>=400&&s<500?(t(st,`Unrecoverable upload failure while attempting to send ping ${r}. Error was: ${null!=s?s:"no status"}.`,e.Warn),void this.pingsDatabase.deletePing(r)):(t(st,[`Recoverable upload failure while attempting to send ping ${r}, will retry.`,`Error was: ${null!=s?s:"no status"}.`],e.Warn),this.recoverableFailureCount++,void this.enqueuePing(n))}clearPendingPingsQueue(){this.queue=this.queue.filter((e=>We(e)))}blockUploads(){this.worker.blockUploading()}resumeUploads(){this.worker.resumeUploading()}update(e,t){this.enqueuePing({identifier:e,...t}),this.worker.isBlocking||(this.processing["delete"](e),this.pingsDatabase.deletePing(e)),this.worker.work((()=>this.getUploadTask()),((e,t)=>this.processPingUploadResponse(e,t)))}enqueuePing(e){if(!this.processing.has(e.identifier)){for(const t of this.queue)if(t.identifier===e.identifier)return;this.queue.push(e)}}getUploadTaskInternal(){if(this.recoverableFailureCount>=this.policy.maxRecoverableFailures)return t(st,"Glean has reached maximum recoverable upload failures for the current uploading window.",e.Debug),nt();if(this.queue.length>0){const{state:n,remainingTime:i}=this.rateLimiter.getState();if(1===n)return t(st,["Glean is currently throttled.",`Pending pings may be uploaded in ${(i||0)/1e3}s.`],e.Debug),this.waitAttemptCount++,this.waitAttemptCount>this.policy.maxWaitAttempts?nt():it(i||0);const r=this.queue.shift();return this.processing.add(r.identifier),rt(r)}return nt()}};class ot extends I{constructor(e){super(e)}validate(e){return{type:w.Success}}payload(){return this.inner}}const ct="__other__",lt=/^[a-z_][a-z0-9_-]{0,29}(\.[a-z_][a-z0-9_-]{0,29})*$/;function dt(e,t){return`${e}/${t}`}class ut{constructor(e,t,n){n&&l.addSupportedMetric(e,n),this.type=e,this.name=t.name,this.category=t.category,this.sendInPings=t.sendInPings,this.lifetime=t.lifetime,this.disabled=t.disabled,this.dynamicLabel=t.dynamicLabel}baseIdentifier(){return this.category.length>0?`${this.category}.${this.name}`:this.name}identifier(){const e=this.baseIdentifier();return x(this.dynamicLabel)?e:function(e){if(e.dynamicLabel===undefined)throw new Error("This point should never be reached.");const t=dt(e.baseIdentifier(),e.dynamicLabel);for(const n of e.sendInPings)if(l.metricsDatabase.hasMetric(e.lifetime,n,e.type,t))return t;let n=0;for(const t of e.sendInPings)n+=l.metricsDatabase.countByBaseIdentifier(e.lifetime,t,e.type,e.baseIdentifier());let i=!1;return n>=16?i=!0:e.dynamicLabel.length>61?(i=!0,l.errorManager.record(e,y.InvalidLabel,`Label length ${e.dynamicLabel.length} exceeds maximum of 61.`)):lt.test(e.dynamicLabel)||(i=!0,l.errorManager.record(e,y.InvalidLabel,`Label must be snake_case, got '${e.dynamicLabel}'.`)),i?dt(e.baseIdentifier(),ct):t}(this)}shouldRecord(e){return e&&!this.disabled}testGetNumRecordedErrors(e,t=this.sendInPings[0]){return O("testGetNumRecordedErrors")?l.errorManager.testGetNumRecordedErrors(this,e,t):0}}function gt(e,t){e.startsWith("labeled_")&&l.addSupportedMetric(e,ot);const n=l.getSupportedMetric(e);if(!n)throw new Error(`Unable to create metric of unknown type "${e}".`);return new n(t)}function ft(n,i){try{return gt(n,i),!0}catch(In){return t("Glean.core.Metrics.utils",In.message,e.Error),!1}}function pt(e){return P(e)?{type:w.Success}:{type:w.Error,errorMessage:`Expected string value, got ${JSON.stringify(e)}`}}var ht,mt=undefined&&undefined.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},bt=undefined&&undefined.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};const vt=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;class yt extends I{constructor(e){super(e)}validate(e){const t=pt(e);if(t.type===w.Error)return t;const n=e;return vt.test(n)?{type:w.Success}:{type:w.Error,errorMessage:`"${n}" is not a valid UUID`,errorType:y.InvalidValue}}payload(){return this.inner}}class wt extends ut{constructor(e){super("uuid",e,yt)}set(e){if(!this.shouldRecord(l.uploadEnabled))return;let t;e||(e=k());try{t=new yt(e),l.metricsDatabase.record(this,t)}catch(In){In instanceof E&&In.recordError(this)}}generateAndSet(){if(!this.shouldRecord(l.uploadEnabled))return;const e=k();return this.set(e),e}testGetValue(e=this.sendInPings[0]){if(O("testGetValue","core.metrics.UUIDMetricType"))return l.metricsDatabase.getMetric(e,this)}}var St,Et=class{constructor(e){ht.set(this,void 0),mt(this,ht,new wt(e),"f")}set(e){bt(this,ht,"f").set(e)}generateAndSet(){return bt(this,ht,"f").generateAndSet()}testGetValue(e=bt(this,ht,"f").sendInPings[0]){return bt(this,ht,"f").testGetValue(e)}testGetNumRecordedErrors(e,t=bt(this,ht,"f").sendInPings[0]){return bt(this,ht,"f").testGetNumRecordedErrors(e,t)}};ht=new WeakMap,function(e){e.Nanosecond="nanosecond",e.Microsecond="microsecond",e.Millisecond="millisecond",e.Second="second",e.Minute="minute",e.Hour="hour",e.Day="day"}(St||(St={}));var It=St;undefined&&undefined.__classPrivateFieldSet,undefined&&undefined.__classPrivateFieldGet;class Dt extends I{constructor(e){super(e)}static fromDate(e,t){if(!(e instanceof Date))throw new E(`Expected Date object, got ${JSON.stringify(e)}`);return new Dt({timeUnit:t,timezone:e.getTimezoneOffset(),date:e.toISOString()})}get date(){return new Date(this.inner.date)}get timezone(){return this.inner.timezone}get timeUnit(){return this.inner.timeUnit}get dateISOString(){return this.inner.date}validate(e){if(!T(e)||3!==Object.keys(e).length)return{type:w.Error,errorMessage:`Expected Glean datetime metric object, got ${JSON.stringify(e)}`};const t="timeUnit"in e&&P(e.timeUnit)&&Object.values(It).includes(e.timeUnit),n="timezone"in e&&$(e.timezone),i="date"in e&&P(e.date)&&24===e.date.length&&!isNaN(Date.parse(e.date));return t&&n&&i?{type:w.Success}:{type:w.Error,errorMessage:`Invalid property on datetime metric, got ${JSON.stringify(e)}`}}payload(){const e=this.dateISOString.match(/\d+/g);if(!e||e.length<0)throw new Error("IMPOSSIBLE: Unable to extract date information from DatetimeMetric.");const t=new Date(parseInt(e[0]),parseInt(e[1])-1,parseInt(e[2]),parseInt(e[3])-this.timezone/60,parseInt(e[4]),parseInt(e[5]),parseInt(e[6])),n=function(e){const t=e/60*-1;return`${t>0?"+":"-"}${Math.abs(t).toString().padStart(2,"0")}:00`}(this.timezone),i=t.getFullYear().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getDate().toString().padStart(2,"0");if(this.timeUnit===It.Day)return`${i}-${r}-${s}${n}`;const a=t.getHours().toString().padStart(2,"0");if(this.timeUnit===It.Hour)return`${i}-${r}-${s}T${a}${n}`;const o=t.getMinutes().toString().padStart(2,"0");if(this.timeUnit===It.Minute)return`${i}-${r}-${s}T${a}:${o}${n}`;const c=t.getSeconds().toString().padStart(2,"0");if(this.timeUnit===It.Second)return`${i}-${r}-${s}T${a}:${o}:${c}${n}`;const l=t.getMilliseconds().toString().padStart(3,"0");return this.timeUnit===It.Millisecond?`${i}-${r}-${s}T${a}:${o}:${c}.${l}${n}`:this.timeUnit===It.Microsecond?`${i}-${r}-${s}T${a}:${o}:${c}.${l}000${n}`:`${i}-${r}-${s}T${a}:${o}:${c}.${l}000000${n}`}}class Tt extends ut{constructor(e,t){super("datetime",e,Dt),this.timeUnit=t}set(e){if(!this.shouldRecord(l.uploadEnabled))return;const t=this.truncateDate(e);try{const e=Dt.fromDate(t,this.timeUnit);l.metricsDatabase.record(this,e)}catch(In){In instanceof E&&In.recordError(this)}}truncateDate(e){e||(e=new Date);const t=e;switch(this.timeUnit){case It.Day:t.setMilliseconds(0),t.setSeconds(0),t.setMinutes(0),t.setMilliseconds(0);case It.Hour:t.setMilliseconds(0),t.setSeconds(0),t.setMinutes(0);case It.Minute:t.setMilliseconds(0),t.setSeconds(0);case It.Second:t.setMilliseconds(0)}return t}testGetValueAsDatetimeMetric(e,t){if(O(t,"core.metrics.DatetimeMetricType")){const t=l.metricsDatabase.getMetric(e,this);if(t)return new Dt(t)}}testGetValueAsString(e=this.sendInPings[0]){const t=this.testGetValueAsDatetimeMetric(e,"testGetValueAsString");return t?t.payload():undefined}testGetValue(e=this.sendInPings[0]){const t=this.testGetValueAsDatetimeMetric(e,"testGetValue");return t?t.date:undefined}}new WeakMap;undefined&&undefined.__classPrivateFieldSet,undefined&&undefined.__classPrivateFieldGet;class xt extends I{constructor(e){super(e)}validate(e){return pt(e)}payload(){return this.inner}}class Pt extends ut{constructor(e){super("string",e,xt)}set(e){if(this.shouldRecord(l.uploadEnabled))try{const t=A(this,e,100),n=new xt(t);l.metricsDatabase.record(this,n)}catch(In){In instanceof E&&In.recordError(this)}}testGetValue(e=this.sendInPings[0]){if(O("testGetValue","core.metrics.StringMetricType"))return l.metricsDatabase.getMetric(e,this)}}new WeakMap;undefined&&undefined.__classPrivateFieldSet,undefined&&undefined.__classPrivateFieldGet;const Mt="core.metrics.CounterMetricType";class $t extends I{constructor(e){super(e)}validate(e){return function(e,t=!0){return _(e)?(t?e<0:e<=0)?{type:w.Error,errorMessage:`Expected positive value, got ${JSON.stringify(e)}`,errorType:y.InvalidValue}:{type:w.Success}:{type:w.Error,errorMessage:`Expected integer value, got ${JSON.stringify(e)}`}}(e,!1)}payload(){return this.inner}saturatingAdd(e){const t=this.validateOrThrow(e);this.inner=function(...e){let t=e.reduce(((e,t)=>e+t),0);return t>Number.MAX_SAFE_INTEGER&&(t=Number.MAX_SAFE_INTEGER),t}(this.inner,t)}}class _t extends ut{constructor(e){super("counter",e,$t)}add(e){if(this.shouldRecord(l.uploadEnabled)){x(e)&&(e=1);try{l.metricsDatabase.transform(this,this.transformFn(e))}catch(In){In instanceof E&&In.recordError(this)}}}transformFn(e){return n=>{const i=new $t(e);if(n)try{i.saturatingAdd(n)}catch(se){t(Mt,`Unexpected value found in storage for metric ${this.name}: ${JSON.stringify(n)}. Overwriting.`)}return i}}testGetValue(e=this.sendInPings[0]){if(O("testGetValue",Mt))return l.metricsDatabase.getMetric(e,this)}}new WeakMap;class Ut{constructor(){this.clientId=new wt({name:"client_id",category:"",sendInPings:["glean_client_info"],lifetime:"user",disabled:!1}),this.firstRunDate=new Tt({name:"first_run_date",category:"",sendInPings:["glean_client_info"],lifetime:"user",disabled:!1},It.Day),this.os=new Pt({name:"os",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.osVersion=new Pt({name:"os_version",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.architecture=new Pt({name:"architecture",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.locale=new Pt({name:"locale",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.appChannel=new Pt({name:"app_channel",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.appBuild=new Pt({name:"app_build",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.appDisplayVersion=new Pt({name:"app_display_version",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.buildDate=new Tt({name:"build_date",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1},"second"),this.sessionId=new wt({name:"session_id",category:"",sendInPings:["glean_client_info"],lifetime:"user",disabled:!1}),this.sessionCount=new _t({name:"session_count",category:"",sendInPings:["glean_client_info"],lifetime:"user",disabled:!1})}initialize(){!l.testing&&z()||(this.initializeClientId(),this.initializeFirstRunDate(),this.updateSessionInfo(),this.os.set(l.platform.info.os()),this.osVersion.set(l.platform.info.osVersion()),this.architecture.set(l.platform.info.arch()),this.locale.set(l.platform.info.locale()),this.appBuild.set(l.config.appBuild||"Unknown"),this.appDisplayVersion.set(l.config.appDisplayVersion||"Unknown"),l.config.channel&&this.appChannel.set(l.config.channel),l.config.buildDate&&this.buildDate.set())}updateSessionInfo(){if(z())return;if(l.metricsDatabase.getMetric(F,this.sessionId))try{(function(e=30){const t=localStorage.getItem("glean_session_last_active"),n=new Date(Number(t)),i=new Date;return i.setMinutes(i.getMinutes()-e),i>n})(l.config.sessionLengthInMinutesOverride)&&this.generateNewSession()}catch(In){this.generateNewSession()}else this.generateNewSession();localStorage.setItem("glean_session_last_active",Date.now().toString())}initializeClientId(){let n=!1;const i=l.metricsDatabase.getMetric(F,this.clientId);if(i)try{gt("uuid",i).payload()===W&&(n=!0)}catch(se){t("core.InternalMetrics","Unexpected value found for Glean clientId. Ignoring.",e.Warn),n=!0}else n=!0;n&&this.clientId.set(k())}initializeFirstRunDate(){l.metricsDatabase.getMetric(F,this.firstRunDate)||this.firstRunDate.set()}generateNewSession(){this.sessionId.generateAndSet(),this.sessionCount.add()}}const kt="core.Pings.Maker";function Ct(e){const{startTimeMetric:t,startTime:n}=function(e){const t=new Tt({category:"",name:`${e.name}#start`,sendInPings:[B],lifetime:"user",disabled:!1},It.Minute),n=l.metricsDatabase.getMetric(B,t);let i;return i=n?new Dt(n):Dt.fromDate(l.startTime,It.Minute),{startTimeMetric:t,startTime:i}}(e),i=new Date;t.set(i);const r=Dt.fromDate(i,It.Minute);return{startTime:n.payload(),endTime:r.payload()}}function At(n,i){const r=function(n){const i=new _t({category:"",name:`${n.name}#sequence`,sendInPings:[B],lifetime:"user",disabled:!1}),r=l.metricsDatabase.getMetric(B,i);if(i.add(1),r)try{return new $t(r).payload()}catch(In){t(kt,`Unexpected value found for sequence number in ping ${n.name}. Ignoring.`,e.Warn)}return 0}(n),{startTime:s,endTime:a}=Ct(n),o={seq:r,start_time:s,end_time:a};return i&&(o.reason=i),o}function Ot(n,i){const r=l.eventsDatabase.getPingEvents(n.name,!0);let s=l.metricsDatabase.getPingMetrics(n.name,!0);if(!s&&!r){if(!n.sendIfEmpty)return void t(kt,`Storage for ${n.name} empty. Bailing out.`,e.Info);t(kt,`Storage for ${n.name} empty. Ping will still be sent.`,e.Info)}n.includeClientId&&l.config.experimentationId&&(s=s!==undefined?{...s,string:{...(null==s?void 0:s.string)||undefined,"glean.client.annotation.experimentation_id":l.config.experimentationId}}:{string:{"glean.client.annotation.experimentation_id":l.config.experimentationId}});const a=s?{metrics:s}:{},o=r?{events:r}:{},c=At(n,i),d=function(n){let i=l.metricsDatabase.getPingMetrics(F,!0);i||(t(kt,"Empty client info data. Will submit anyways.",e.Warn),i={});let r={telemetry_sdk_build:R};for(const e in i)r={...r,...i[e]};return n.includeClientId||(delete r.client_id,delete r.session_id),r}(n);return{...a,...o,ping_info:c,client_info:d}}var zt=function(n,i,r){const s=Ot(i,r);if(!s)return;l.config.logPings&&t(kt,JSON.stringify(s,null,2),e.Info);const a=function(){const e={};if(l.config.debugViewTag&&(e["X-Debug-ID"]=l.config.debugViewTag),l.config.sourceTags&&(e["X-Source-Tags"]=l.config.sourceTags.toString()),Object.keys(e).length>0)return e}();l.pingsDatabase.recordPing(function(e,t){return`/submit/${l.applicationId}/${t.name}/${V}/${e}`}(n,i),n,s,a)};undefined&&undefined.__classPrivateFieldSet,undefined&&undefined.__classPrivateFieldGet;const Lt="core.Pings.PingType";class Gt{constructor(e){var t;this.name=e.name,this.includeClientId=e.includeClientId,this.sendIfEmpty=e.sendIfEmpty,this.reasonCodes=null!==(t=e.reasonCodes)&&void 0!==t?t:[],this.preciseTimestamps=e.preciseTimestamps}submit(n){this.testCallback?this.testCallback(n).then((()=>{this.internalSubmit(n,this.resolveTestPromiseFunction)}))["catch"]((i=>{t(Lt,[`There was an error validating "${this.name}" (${null!=n?n:"no reason"}):`,i],e.Error),this.internalSubmit(n,this.rejectTestPromiseFunction)})):this.internalSubmit(n)}internalSubmit(n,i){if(!l.initialized)return void t(Lt,"Glean must be initialized before submitting pings.",e.Info);if(!l.uploadEnabled&&this.name!==j)return void t(Lt,"Glean disabled: not submitting pings. Glean may still submit the deletion-request ping.",e.Info);let r=n;n&&!this.reasonCodes.includes(n)&&(t(Lt,`Invalid reason code ${n} from ${this.name}. Ignoring.`,e.Warn),r=undefined);const s=k();zt(s,this,r),i&&(i(),this.resolveTestPromiseFunction=undefined,this.rejectTestPromiseFunction=undefined,this.testCallback=undefined)}async testBeforeNextSubmit(n){if(O("testBeforeNextSubmit",Lt))return this.testCallback?void t(Lt,`There is an existing test call for ping "${this.name}". Ignoring.`,e.Error):new Promise(((e,t)=>{this.resolveTestPromiseFunction=e,this.rejectTestPromiseFunction=t,this.testCallback=n}))}}new WeakMap;var Nt=class{constructor(){this.deletionRequest=new Gt({name:j,includeClientId:!0,sendIfEmpty:!0,reasonCodes:["at_init","set_upload_enabled"]}),this.events=new Gt({name:J,includeClientId:!0,sendIfEmpty:!1,reasonCodes:["startup","max_capacity"]})}};const Vt="core.Metrics.Database",Rt="reserved#",Bt=`glean.${Rt}`;var Ft=class{constructor(){this.userStore=new l.platform.Storage("userLifetimeMetrics"),this.pingStore=new l.platform.Storage("pingLifetimeMetrics"),this.appStore=new l.platform.Storage("appLifetimeMetrics")}record(e,t){this.transform(e,(()=>t))}transform(e,t){if(e.disabled)return;const n=this.chooseStore(e.lifetime),i=e.identifier();for(const r of e.sendInPings){const s=e=>t(e).get();n.update([r,e.type,i],s)}}hasMetric(e,t,n,i){return!x(this.chooseStore(e).get([t,n,i]))}countByBaseIdentifier(e,t,n,i){const r=this.chooseStore(e).get([t,n]);return x(r)?0:Object.keys(r).filter((e=>e.startsWith(i))).length}getMetric(n,i){const r=this.chooseStore(i.lifetime),s=i.identifier(),a=r.get([n,i.type,s]);return x(a)||ft(i.type,a)?a:(t(Vt,`Unexpected value found for metric ${s}: ${JSON.stringify(a)}. Clearing.`,e.Error),void r["delete"]([n,i.type,s]))}getPingMetrics(e,t){const n=this.getCorrectedPingData(e,"user"),i=this.getCorrectedPingData(e,"ping"),r=this.getCorrectedPingData(e,"application");t&&Object.keys(i).length>0&&this.clear("ping",e);const s={};for(const e of[n,i,r])for(const t in e)for(const n in e[t])n.startsWith(Bt)||(n.includes("/")?this.processLabeledMetric(s,t,n,e[t][n]):s[t]={...s[t],[n]:e[t][n]});return 0===Object.keys(s).length?void 0:function(e){const t={};for(const n in e){const i=e[n];t[n]={};for(const e in i){const r=gt(n,i[e]);t[n][e]=r.payload()}}return t}(s)}clear(e,t){const n=t?[t]:[];this.chooseStore(e)["delete"](n)}clearAll(){this.userStore["delete"]([]),this.pingStore["delete"]([]),this.appStore["delete"]([])}chooseStore(e){switch(e){case"user":return this.userStore;case"ping":return this.pingStore;case"application":return this.appStore}}getCorrectedPingData(n,i){const r=this.chooseStore(i),s=r.get([n]);if(x(s))return{};if(!T(s))return t(Vt,`Invalid value found in storage for ping "${n}". Deleting.`,e.Debug),r["delete"]([n]),{};const a={};for(const i in s){const o=s[i];if(T(o))for(const s in o)ft(i,o[s])?(a[i]||(a[i]={}),a[i][s]=o[s]):(t(Vt,`Invalid value "${JSON.stringify(o[s])}" found in storage for metric "${s}". Deleting.`,e.Debug),r["delete"]([n,i,s]));else t(Vt,`Unexpected data found in storage for metrics of type "${i}" in ping "${n}". Deleting.`,e.Debug),r["delete"]([n,i])}return a}processLabeledMetric(e,t,n,i){const r=`labeled_${t}`,s=n.split("/",2),a=s[0],o=s[1];if(r in e&&a in e[r]){const t=e[r][a];e[r][a]={...t,[o]:i}}else e[r]={...e[r],[a]:{[o]:i}}}};class Wt extends I{constructor(e){super(e)}static withTransformedExtras(e,t){const n=t(e.extra||{});return{category:e.category,name:e.name,timestamp:e.timestamp,extra:n&&Object.keys(n).length>0?n:undefined}}addExtra(e,t){this.inner.extra||(this.inner.extra={}),this.inner.extra[e]=t}withoutReservedExtras(){return Wt.withTransformedExtras(this.get(),(e=>Object.keys(e).filter((e=>!K.includes(e))).reduce(((t,n)=>(t[n]=e[n],t)),{})))}validate(e){if(!T(e))return{type:w.Error,errorMessage:"Expected Glean event object, got "+typeof e};const t="category"in e&&P(e.category),n="name"in e&&P(e.name);if(!t||!n)return{type:w.Error,errorMessage:`Unexpected value for "category" or "name" in event object: ${JSON.stringify(e)}`};if(!("timestamp"in e&&_(e.timestamp)&&e.timestamp>=0))return{type:w.Error,errorMessage:`Event timestamp must be a positive integer, got ${JSON.stringify(e)}`};if(e.extra){if(!T(e.extra))return{type:w.Error,errorMessage:"Expected Glean extras object, got "+typeof e};for(const[t,n]of Object.entries(e.extra)){const e=pt(t);if(e.type===w.Error)return e;if(!P(n)&&!$(n)&&!M(n))return{type:w.Error,errorMessage:`Unexpected value for extra key ${t}: ${JSON.stringify(n)}`}}}return{type:w.Success}}payload(){return Wt.withTransformedExtras(this.withoutReservedExtras(),(e=>Object.keys(e).reduce(((t,n)=>(t[n]=e[n].toString(),t)),{})))}}var jt,Jt=undefined&&undefined.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},qt=undefined&&undefined.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};class Ht extends ut{constructor(e,t){super("event",e),this.allowedExtraKeys=t}record(e,t=C()){if(!this.shouldRecord(l.uploadEnabled))return;const n=Date.now();try{const i=new Wt({category:this.category,name:this.name,timestamp:t,extra:e}),r={};if(e&&this.allowedExtraKeys)for(const[t,n]of Object.entries(e))this.allowedExtraKeys.includes(t)?P(n)?r[t]=A(this,n,500):r[t]=n:l.errorManager.record(this,y.InvalidValue,`Invalid key index: ${t}`);r.glean_timestamp=n.toString(),i.set({...i.get(),extra:r}),l.eventsDatabase.record(this,i)}catch(In){In instanceof E&&In.recordError(this)}}testGetValue(e=this.sendInPings[0]){if(O("testGetValue","core.metrics.EventMetricType")){const t=l.eventsDatabase.getEvents(e,this);return t?(t.forEach((e=>{e.extra&&(delete e.extra.glean_timestamp,0==Object.keys(e.extra).length&&(e.extra=undefined))})),t):t}}}class Kt{constructor(e,t){jt.set(this,void 0),Jt(this,jt,new Ht(e,t),"f")}record(e){qt(this,jt,"f").record(e)}testGetValue(e=qt(this,jt,"f").sendInPings[0]){return qt(this,jt,"f").testGetValue(e)}testGetNumRecordedErrors(e,t=qt(this,jt,"f").sendInPings[0]){return qt(this,jt,"f").testGetNumRecordedErrors(e,t)}}jt=new WeakMap;const Xt="core.Metric.EventsDatabase";function Qt(e,t=l.startTime){en(e).record({[q]:t.toISOString()},0)}function Yt(e){P(e)||(e="");const t=new Date(e);if(isNaN(t.getTime()))throw new Error(`Error attempting to generate Date object from string: ${e}`);return t}function Zt(e){return new _t({...(t="execution_counter",{category:"glean",name:`${Rt}${t}`}),sendInPings:e.filter((e=>e!==J)),lifetime:"ping",disabled:!1});var t}function en(e){return new Ht({category:"glean",name:"restarted",sendInPings:e.filter((e=>e!==J)),lifetime:"ping",disabled:!1},[q])}function tn(e){var t,n;return!!(null===(n=null===(t=null==e?void 0:e.get())||void 0===t?void 0:t.extra)||void 0===n?void 0:n[q])}var nn=class{constructor(){this.initialized=!1,this.eventsStore=new l.platform.Storage("events")}initialize(){var e;if(this.initialized)return;const t=this.getAvailableStoreNames();if(t.includes(J)){const t=null!==(e=this.eventsStore.get([J]))&&void 0!==e?e:[];t.length>0&&t.length>=l.config.maxEvents&&l.corePings.events.submit("startup")}Zt(t).add(1),Qt(t),this.initialized=!0}record(e,t){if(!e.disabled)for(const n of e.sendInPings){const e=Zt([n]);let i=l.metricsDatabase.getMetric(n,e);i||(e.add(1),i=1,Qt([n],new Date)),t.addExtra(H,i);let r=0;const s=e=>{var n;const i=null!==(n=e)&&void 0!==n?n:[];return i.push(t.get()),r=i.length,i};this.eventsStore.update([n],s),n===J&&r>=l.config.maxEvents&&l.corePings.events.submit("max_capacity")}}getEvents(e,t){const n=this.getAndValidatePingData(e);if(0!==n.length)return n.filter((e=>e.get().category===t.category&&e.get().name===t.name)).map((e=>e.withoutReservedExtras()))}getPingEvents(e,t){const n=this.getAndValidatePingData(e);if(t&&Object.keys(n).length>0&&this.eventsStore["delete"]([e]),0===n.length)return;const i=this.prepareEventsPayload(e,n);return i.length>0?i:void 0}clearAll(){this.eventsStore["delete"]([])}getAvailableStoreNames(){const e=this.eventsStore.get([]);return x(e)?[]:Object.keys(e)}getAndValidatePingData(n){const i=this.eventsStore.get([n]);return x(i)?[]:Array.isArray(i)?i.reduce(((e,n)=>{try{const t=new Wt(n);return[...e,t]}catch(se){return t(Xt,`Unexpected data found in events storage: ${JSON.stringify(n)}. Ignoring.`),e}}),[]):(t(Xt,`Unexpected value found for ping ${n}: ${JSON.stringify(i)}. Clearing.`,e.Error),this.eventsStore["delete"]([n]),[])}prepareEventsPayload(e,t){var n,i,r,s;let a,o=t.sort(((e,t)=>{var n,i;const r=Number(null===(n=e.get().extra)||void 0===n?void 0:n[H]),s=Number(null===(i=t.get().extra)||void 0===i?void 0:i[H]);return r!==s?r-s:e.get().timestamp-t.get().timestamp}));try{a=Yt(null===(n=o[0].get().extra)||void 0===n?void 0:n[q]),o.shift()}catch(u){a=l.startTime}const c=(null===(i=o[0])||void 0===i?void 0:i.get().timestamp)||0;let d=0;for(const[t,n]of o.entries()){try{const i=Yt(null===(r=n.get().extra)||void 0===r?void 0:r[q]),s=i.getTime()-a.getTime();a=i;const c=d+s,u=o[t-1].get().timestamp;c<=u?(d=u+1,l.errorManager.record(en([e]),y.InvalidValue,`Invalid time offset between application sessions found for ping "${e}". Ignoring.`)):d=c}catch(g){}let i;i=1===Number((null===(s=n.get().extra)||void 0===s?void 0:s[H])||1)?n.get().timestamp-c:n.get().timestamp+d,o[t]=new Wt({category:n.get().category,name:n.get().name,timestamp:i,extra:n.get().extra})}return o=function(e){for(;e.length&&tn(e[e.length-1]);)e.pop();return e}(o),o.map((e=>e.payload()))}};function rn(e,t){const n=function(e){return e.split("/")[0]}(e.baseIdentifier());return new _t({name:dt(t,n),category:"glean.error",lifetime:"ping",sendInPings:e.sendInPings,disabled:!1})}class sn{record(e,n,i,r=1){const s=rn(e,n);t(function(e){return`core.metrics.${e.type.charAt(0).toUpperCase()+e.type.slice(1)}`}(e),[`${e.baseIdentifier()}:`,i]),r>0&&s.add(r)}testGetNumRecordedErrors(e,t,n){return rn(e,t).testGetValue(n)||0}}const an="core.glean_metrics";var on;!function(n){const i={pageLoad:new Kt({category:"glean",name:"page_load",sendInPings:[J],lifetime:"ping",disabled:!1},["url","referrer","title"]),elementClick:new Kt({category:"glean",name:"element_click",sendInPings:[J],lifetime:"ping",disabled:!1},["id","type","label"]),pageId:new Et({category:"glean",name:"page_id",sendInPings:[J],lifetime:"application",disabled:!1})};function r(n){l.initialized?i.elementClick.record(n):t(an,"Attempted to record element click event before Glean was initialized. This is a no-op.",e.Warn)}n.pageLoad=function(n){var r,s,a;l.initialized?(i.pageId.generateAndSet(),i.pageLoad.record({url:null!==(r=null==n?void 0:n.url)&&void 0!==r?r:"undefined"!=typeof window?window.location.href:"URL_NOT_PROVIDED_OR_AVAILABLE",referrer:null!==(s=null==n?void 0:n.referrer)&&void 0!==s?s:"undefined"!=typeof document?document.referrer:"REFERRER_NOT_PROVIDED_OR_AVAILABLE",title:null!==(a=null==n?void 0:n.title)&&void 0!==a?a:"undefined"!=typeof document?document.title:"TITLE_NOT_PROVIDED_OR_AVAILABLE"})):t(an,"Attempted to record a page load event before Glean was initialized. This is a no-op.",e.Warn)},n.handleClickEvent=function(e){const t=e.target.closest("[data-glean-id], [data-glean-type], [data-glean-label]");if(!t)return;r(function(e){const t=e.dataset;return{...t.gleanId&&{id:t.gleanId},...t.gleanType&&{type:t.gleanType},...t.gleanLabel&&{label:t.gleanLabel}}}(t))},n.recordElementClick=r}(on||(on={}));var cn=on;const ln="core.Glean";var dn;!function(e){e.DebugTag="DebugTag",e.SourceTags="SourceTags",e.LogPings="LogPings"}(dn||(dn={}));const un=(e,t)=>{const n=`Glean.${e.toString()}`;switch(e){case dn.DebugTag:sessionStorage.setItem(n,t);break;case dn.LogPings:sessionStorage.setItem(n,t.toString());break;case dn.SourceTags:sessionStorage.setItem(n,t.join(","))}},gn=e=>sessionStorage.getItem(`Glean.${e.toString()}`)||undefined;var fn;!function(n){function i(){l.uploadEnabled=!0,n.pingUploader.resumeUploads()}function r(e){let t;t=e?"at_init":"set_upload_enabled",l.uploadEnabled=!1,l.corePings.deletionRequest.submit(t),s()}function s(){let e;n.pingUploader.clearPendingPingsQueue();try{e=new Dt(l.metricsDatabase.getMetric(F,l.coreMetrics.firstRunDate)).date}catch(se){e=new Date}l.eventsDatabase.clearAll(),l.metricsDatabase.clearAll(),l.pingsDatabase.clearAll(),l.uploadEnabled=!0,l.coreMetrics.clientId.set(W),l.coreMetrics.firstRunDate.set(e),l.uploadEnabled=!1}function a(){if("undefined"==typeof window||"undefined"==typeof window.sessionStorage)return;const e=gn(dn.LogPings);var t;e&&(n.preInitLogPings="true"===(t=e).toLowerCase()||"false"!==t.toLowerCase()&&undefined);const i=gn(dn.DebugTag);i&&(n.preInitDebugViewTag=i);const r=gn(dn.SourceTags);r&&(n.preInitSourceTags=r.split(","))}n.initialize=function(o,c,d){if(l.initialized)t(ln,"Attempted to initialize Glean, but it has already been initialized. Ignoring.",e.Warn);else if(P(o))if(M(c))if(0!==o.length)if(l.platform){if(l.coreMetrics=new Ut,l.corePings=new Nt,l.applicationId=function(e){return e.replace(/[^a-z0-9]+/gi,"-").toLowerCase()}(o),l.config=new Q(d),a(),n.preInitLogPings&&(l.config.logPings=n.preInitLogPings),n.preInitDebugViewTag&&(l.config.debugViewTag=n.preInitDebugViewTag),n.preInitSourceTags&&(l.config.sourceTags=n.preInitSourceTags),l.metricsDatabase=new Ft,l.eventsDatabase=new nn,l.pingsDatabase=new qe,l.errorManager=new sn,n.pingUploader=new at(l.config,l.pingsDatabase),l.initialized=!0,l.uploadEnabled=c,l.eventsDatabase.initialize(),c)l.metricsDatabase.clear("application"),i(),l.coreMetrics.initialize(),(null==d?void 0:d.enableAutoPageLoadEvents)&&cn.pageLoad(),(null==d?void 0:d.enableAutoElementClickEvents)&&document.addEventListener("click",(e=>{cn.handleClickEvent(e)}));else{const e=l.metricsDatabase.getMetric(F,l.coreMetrics.clientId);e?e!==W&&r(!0):s()}l.pingsDatabase.scanPendingPings()}else t(ln,"Unable to initialize Glean, platform has not been set.",e.Error);else t(ln,"Unable to initialize Glean, applicationId cannot be an empty string.",e.Error);else t(ln,"Unable to initialize Glean, uploadEnabled must be a boolean.",e.Error);else t(ln,"Unable to initialize Glean, applicationId must be a string.",e.Error)},n.setUploadEnabled=function(n){l.initialized?M(n)?l.uploadEnabled!==n&&(n?(i(),l.coreMetrics.initialize()):r(!1)):t(ln,"Unable to change upload state, new value must be a boolean. Ignoring.",e.Error):t(ln,["Changing upload enabled before Glean is initialized is not supported.\n","Pass the correct state into `initialize`.\n","See documentation at https://mozilla.github.io/glean/book/user/general-api.html#initializing-the-glean-sdk`"],e.Error)},n.setExperimentationId=function(e){l.config.experimentationId=e},n.setLogPings=function(e){l.initialized?l.config.logPings=e:n.preInitLogPings=e},n.setDebugViewTag=function(e){l.initialized?l.config.debugViewTag=e:n.preInitDebugViewTag=e},n.setSourceTags=function(e){l.initialized?l.config.sourceTags=e:n.preInitSourceTags=e},n.setPlatform=function(n){l.initialized||(l.isPlatformSet()&&l.platform.name!==n.name&&!l.testing&&t(ln,[`IMPOSSIBLE: Attempted to change Glean's targeted platform",\n            "from "${l.platform.name}" to "${n.name}". Ignoring.`],e.Error),l.platform=n)}}(fn||(fn={})),"undefined"!=typeof window&&"undefined"!=typeof window.sessionStorage&&(window.Glean={setLogPings:e=>{un(dn.LogPings,e),fn.setLogPings(e),console.log("Pings will be logged to the console until this tab is closed.")},setDebugViewTag:e=>{un(dn.DebugTag,e),fn.setDebugViewTag(e),console.log("Pings will be sent to the Debug Ping Viewer until this tab is closed. Pings can be found here: https://debug-ping-preview.firebaseapp.com/.")},setSourceTags:e=>{un(dn.SourceTags,e),fn.setSourceTags(e),console.log("Pings will be given the specified tags until the tab is closed.")},debugSession:()=>{const e=l.metricsDatabase.getMetric(F,l.coreMetrics.sessionId);e&&"string"==typeof e&&l.config.debugViewTag?window.open(`https://debug-ping-preview.firebaseapp.com/stream/${l.config.debugViewTag}#${e}`,"_blank"):console.info("You must set a debug tag via `window.Glean.setDebugViewTag` before debugging your session.")}});var pn=fn;var hn,mn=(hn=N,{initialize(e,t,n){pn.setPlatform(hn),pn.initialize(e,t,n)},setUploadEnabled(e){pn.setUploadEnabled(e)},setLogPings(e){pn.setLogPings(e)},setDebugViewTag(e){pn.setDebugViewTag(e)},setSourceTags(e){pn.setSourceTags(e)}});const bn=new Kt({category:"page",name:"interaction",sendInPings:["events"],lifetime:"ping",disabled:!1},["label","type"]),vn=new Kt({category:"page",name:"non_interaction",sendInPings:["events"],lifetime:"ping",disabled:!1},["label","type"]);function yn(e){return yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yn(e)}var wn="moz-consent-pref";function Sn(){try{return JSON.parse(window.Mozilla.Cookies.getItem(wn))}catch(In){return!1}}var En={filterURL:function(e){try{var t=new URL(e);return["/newsletter/existing/","/newsletter/country/"].forEach((function(e){var n=t.pathname.indexOf(e);if(-1!==n){var i=t.pathname.substring(0,n+e.length);t.pathname=i}})),t.toString()}catch(In){return e}},isFirefoxDownloadThanks:function(){return"string"==typeof(e=window.location.href)&&e.indexOf("/firefox/download/thanks/")>-1;var e},initGlean:function(e){var t=window.location.href,n="https://www.mozilla.org",i=t.startsWith(n)?"prod":"non-prod";t.includes("automation=true")&&mn.setSourceTags(["automation"]),mn.initialize("bedrock",e,{channel:i,serverEndpoint:n,enableAutoElementClickEvents:!0})},initPageLoadEvent:function(){cn.pageLoad({url:En.filterURL(window.location.href),referrer:En.filterURL(document.referrer)})},initHelpers:function(){"undefined"==typeof window.Mozilla&&(window.Mozilla={}),window.Mozilla.Glean={pageEvent:function(e){try{!function(e){if("object"===yn(e)||"string"==typeof e.label){var t={label:e.label,type:""};"string"==typeof e.type&&(t.type=e.type);try{"boolean"==typeof e.nonInteraction&&!0===e.nonInteraction?vn.record(t):bn.record(t)}catch(In){}}}(e)}catch(In){}},clickEvent:function(e){try{cn.recordElementClick(e)}catch(In){}}}},configureGlean:function(e){En.initGlean(e),e&&(En.initPageLoadEvent(),En.initHelpers())},handleConsent:function(e){En.configureGlean(e.detail.analytics),window.removeEventListener("mozConsentStatus",En.handleConsent,!1)},bootstrapGlean:function(){if((i=document.getElementsByTagName("html")[0].getAttribute("data-needs-consent"))&&"true"===i.toLowerCase()){var e=Sn();En.isFirefoxDownloadThanks(window.location.href)&&e&&e.analytics?En.configureGlean(e.analytics):window.addEventListener("mozConsentStatus",En.handleConsent,!1)}else{var t=Sn(),n=!t||t.analytics;En.configureGlean(n)}var i}};En.bootstrapGlean()}();hiz      gu%gu%Gz	   `    O^partitionKey=%28https%2Cmozilla.org%29,:https://www.mozilla.org/media/js/glean.f0ce2425d2c8.js necko:classified 1 strongly-framed 1 security-info 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 request-method GET response-head HTTP/2 200 OK
expires: Fri, 08 Nov 2024 17:45:39 GMT
last-modified: Thu, 07 Nov 2024 23:33:33 GMT
etag: "f0ce2425d2c8ab50051d65653171bf84"
x-goog-generation: 1731022413170182
x-goog-metageneration: 1
x-goog-stored-content-encoding: identity
x-goog-stored-content-length: 61358
x-goog-meta-goog-reserved-file-mtime: 1731022303
content-type: text/javascript
x-goog-hash: crc32c=maezaQ==, md5=8M4kJdLIq1AFHWVlMXG/hA==
x-goog-storage-class: STANDARD
access-control-expose-headers: *
x-guploader-uploadid: AHmUCY3H_MvT6ixHfOanL7jNjE6GoG5yO0Gb8meZXgq9d1P6JONSkwbwMsi2zzCCaMvaK2faepg
server: UploadServer
via: 1.1 varnish, 1.1 varnish
cache-control: max-age=315360000, public, immutable
accept-ranges: bytes
date: Wed, 01 Jan 2025 11:23:34 GMT
age: 3673626
access-control-allow-origin: https://prod.cms.bedrock.prod.webservices.mozgcp.net
x-served-by: cache-bfi-krnt7300041-BFI, cache-bom4723-BOM
x-cache: HIT, HIT
x-cache-hits: 55858, 72801
x-timer: S1735730614.060018,VS0,VE0
content-length: 61358
X-Firefox-Spdy: h2
 original-response-headers expires: Fri, 08 Nov 2024 17:45:39 GMT
last-modified: Thu, 07 Nov 2024 23:33:33 GMT
etag: "f0ce2425d2c8ab50051d65653171bf84"
x-goog-generation: 1731022413170182
x-goog-metageneration: 1
x-goog-stored-content-encoding: identity
x-goog-stored-content-length: 61358
x-goog-meta-goog-reserved-file-mtime: 1731022303
content-type: text/javascript
x-goog-hash: crc32c=maezaQ==
x-goog-hash: md5=8M4kJdLIq1AFHWVlMXG/hA==
x-goog-storage-class: STANDARD
access-control-expose-headers: *
x-guploader-uploadid: AHmUCY3H_MvT6ixHfOanL7jNjE6GoG5yO0Gb8meZXgq9d1P6JONSkwbwMsi2zzCCaMvaK2faepg
server: UploadServer
via: 1.1 varnish, 1.1 varnish
cache-control: max-age=315360000, public, immutable
accept-ranges: bytes
date: Wed, 01 Jan 2025 11:23:34 GMT
age: 3673626
access-control-allow-origin: https://prod.cms.bedrock.prod.webservices.mozgcp.net
x-served-by: cache-bfi-krnt7300041-BFI, cache-bom4723-BOM
x-cache: HIT, HIT
x-cache-hits: 55858, 72801
x-timer: S1735730614.060018,VS0,VE0
content-length: 61358
X-Firefox-Spdy: h2
 ctid 2 uncompressed-len 0 net-response-time-onstart 308 net-response-time-onstop 611   